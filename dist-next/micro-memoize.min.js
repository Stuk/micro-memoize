!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self)["micro-memoize"]=i()}(this,(function(){"use strict";var t=function(){function t(t){this.h=null,this.s=0,this.t=null;var h=n("function",t.transformKey);this.a=n("function",t.matchesArg,e),this.l=n("number",t.maxSize,1),this.m=n("function",t.matchesKey,this.e),this.o=n("function",t.onCache),this.p=n("boolean",t.async,!1),this.c=!!h||t.matchesKey===this.m,this.k=this.c?h?function(t){return h(i(t))}:i:void 0}return t.prototype.clear=function(){this.h=this.t=null,this.s=0},t.prototype.delete=function(t){var i=t.n,n=t.p;i?i.p=n:this.t=n,n?n.n=i:this.h=i,--this.s,this.o&&this.o("delete",h(t),this)},t.prototype.has=function(t){return!!this.g(t)},t.prototype.set=function(t,i){var n=this.g(t);if(!n){var e=this.n(t,i);return this.o&&this.o("add",h(e),this),e}return n.v=i,n!==this.h&&this.u(n),this.o&&this.o("update",h(n),this),n},t.prototype.snapshot=function(){for(var t=[],i=this.h;null!=i;)t.push(h(i)),i=i.n;return t},t.prototype.e=function(t,i){var n=i.length;if(t.length!==n)return!1;if(1===n)return this.a(t[0],i[0]);for(var h=0;h<n;++h)if(!this.a(t[h],i[h]))return!1;return!0},t.prototype.f=function(t){if(this.h){if(this.m(this.h.k,t))return this.o&&this.o("hit",h(this.h),this),this.h;if(this.h!==this.t)for(var i=this.h.n;i;){if(this.m(i.k,t))return this.u(i),this.o&&this.o("update",h(i),this),i;i=i.n}}},t.prototype.g=function(t){for(var i=this.h;i;){if(this.m(i.k,t))return i;i=i.n}},t.prototype.n=function(t,i){var n=this;this.p&&(i=i.then((function(t){return n.o&&n.o("resolved",h(s),n),t}),(function(t){throw n.delete(s),t})));var e=this.h,o=this.t,s={k:t,n:e,p:null,v:i};return this.h=s,e?e.p=s:this.t=s,++this.s>this.l&&o&&this.delete(o),s},t.prototype.u=function(t){var i=t.n,n=t.p;i&&(i.p=n),n&&(n.n=i),this.h.p=t,t.n=this.h,t.p=null,this.h=t,t===this.t&&(this.t=n)},t}();function i(t){for(var i=[],n=0,h=t.length;n<h;++n)i[n]=t[n];return i}function n(t,i,n){return typeof i===t?i:n}function h(t){return{key:t.k,value:t.v}}function e(t,i){return t===i||t!=t&&i!=i}return function n(e,o){if(void 0===o&&(o={}),function(t){return"function"==typeof t&&t.fn}(e))return n(e.fn,Object.assign({},e.options,o));var s=new t(o),r=s.k,u=s.o,f=function(){var t=r?r(arguments):arguments,n=s.f(t);return n||(n=s.n(r?t:i(t),e.apply(this,t)),u&&u("add",h(n),s)),n.v};return f.cache=s,f.fn=e,f.isMemoized=!0,f.options=o,f}}));
