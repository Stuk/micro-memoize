!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self)["micro-memoize"]=e()}(this,(function(){"use strict";function t(t){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=t[n];return e}function e(t,e,n){return typeof e===t?e:n}var n=function(){function n(n){this.entries=[];var r=e("function",n.transformKey);this.isPromise=e("boolean",n.isPromise,!1),this.matchesArg=e("function",n.matchesArg,i),this.matchesKey=e("function",n.matchesKey,this.e),this.maxSize=e("number",n.maxSize,1),this.onChange=e("function",n.onChange),this.c=!!r||n.matchesKey===this.matchesKey,this.transformKey=this.c?r?function(e){return r(t(e))}:t:void 0}return n.prototype.add=function(t,e){var n={key:t,value:e};return this.r(n,this.entries.length),this.onChange&&this.onChange("add",n,this),n},n.prototype.clear=function(){this.entries.length=0},n.prototype.match=function(t){var e=this.entries.length;if(e){var n=this.entries[0];if(this.matchesKey(n.key,t))return this.onChange&&this.onChange("hit",n,this),n;if(1!==e)for(var i=1;i<e;++i)if(n=this.entries[i],this.matchesKey(n.key,t))return this.r(n,i),this.onChange&&this.onChange("update",n,this),n}},n.prototype.remove=function(t){var e=this.entries.indexOf(t);-1!==e&&(this.entries.splice(e,1),this.onChange&&this.onChange("remove",t,this))},n.prototype.snapshot=function(){return this.entries.map((function(t){return{key:t.key,value:t.value}}))},n.prototype.e=function(t,e){var n=e.length;if(t.length!==n)return!1;if(1===n)return this.matchesArg(t[0],e[0]);for(var i=0;i<n;++i)if(!this.matchesArg(t[i],e[i]))return!1;return!0},n.prototype.r=function(t,e){for(var n=this.entries.length,i=e;i--;)this.entries[i+1]=this.entries[i];this.entries[0]=t,n===this.maxSize&&e===n?this.entries.pop():e>=this.maxSize&&(this.entries.length=this.maxSize)},n}();function i(t,e){return t===e||t!=t&&e!=e}return function(e,i){void 0===i&&(i={});var r=new n(i),s=!!r.transformKey,h=function(){var n=s?r.transformKey(arguments):arguments,i=r.match(n);return i||(i=r.add(s?n:t(n),e.apply(this,n)),r.isPromise&&function(t,e){e.value=e.value.then((function(n){if(t.onChange){var i=t.entries.indexOf(e);0===i?t.onChange("hit",e,t):-1!==i&&t.onChange("update",e,t)}return n}),(function(n){throw t.remove(e),n}))}(r,i)),i.value};return h.cache=r,h.fn=e,h.isMemoized=!0,h}}));
